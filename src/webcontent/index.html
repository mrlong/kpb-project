
<%- include('./header.html') %>

<link href="/bootstrap-datepicker/bootstrap-datepicker3.min.css" rel="stylesheet">
<script src="/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>
<script src="/bootstrap-datepicker/bootstrap-datepicker.zh-CN.min.js"></script> 
   
<style>

    
  div.contentleft table.sbdata {
    border: 2px solid #f2f2f2;
    
  }
    
  div.contentleft table.sbdata th{
    color: #d9534f;
    background-color: #f2f2f2;
    padding: 10px; 
  }
  div.contentleft talbe.sbdata td {
     padding: 10px; 
  }

  
  div.contentleft .panel-body{
    padding-top: 0px;
  }
  
  div.contentright  li{
    padding: 4px;
  }
  
  div.contentright  li.active a{
    color: #d9534f;  
  }
  
  div.contentleft .datepicker table tr td, .datepicker table tr th {
    width: 100px;
  }
  
  span.curdate{
    color: #d9534f;
    padding-left: 5px;
    padding-right: 5px;
  }

    
</style>
  
<div class="row">

<div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 contentright">
  
<div class="panel panel-primary">
  <div class="panel-heading">站点</div>
  <div class="panel-body">
    <div id="sandbox-container"></div>
    <ul class="list-unstyled">
      <li class="<%=zcode?'':'active'%>"><a href="/index?date=<%=curdate%>" >全部</a></li>
      <% for(var i=0;i<sblist.length;i++) {%>
        <li class="<%=zcode==sblist[i].STCD?'active':''%>" ><a href="/index?zcode=<%=sblist[i].STCD%>&date=<%=curdate%>"><%=sblist[i].STCD%> <%=sblist[i].NAME%></a></li>
      <%}%>
    </ul>
  </div>
</div>
 
  
  

</div>

<div class="col-lg-9 col-md-9 col-sm-12 col-xs-12 contentleft">  
  
 <div class="panel panel-primary">
  <div class="panel-heading">
    
    <%if(!zcode){%>
      全部 <%=curdate%>
    <%} else {%>
      <% for(var i=0;i<sblist.length;i++) {%> 
        <% if(sblist[i].STCD == zcode) {%>
          <%=sblist[i].NAME%> <%=curdate%>
          <%break;%>
        <%}%> 
      <%}%>
    <%}%>
    
  </div>
  <div class="panel-body">
    <nav>
      <ul class="pager">
        <li class="previous"><a href="/index?date=<%=predate%><%=zcode?'&zcode=' + zcode : '' %>"><span aria-hidden="true">&larr;</span> 前一天</a></li>
        <li><a href="#" data-toggle="modal" data-target=".bs-example-modal-sm" >当前日期 <span class="curdate"><%=curdate%></span> <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>选择</a></li>        
        <li class="next"><a href="/index?date=<%=nextdate%><%=zcode?'&zcode=' + zcode : '' %>">后一天 <span aria-hidden="true">&rarr;</span></a></li>
      </ul>
    </nav>
   
   <table class="table table-hover sbdata" >
    
    <tr>
      <th style="width:50px">序号</th>
      <th style="width:80px">站码</th>
      <th style="width:100px">站名</th>
      <th style="width:100px">接收时间</th>
      <th style="width:80px">上传水位</th>
      <th style="width:80px">实际水位</th>
      
    </tr>
    
    
    <% for(var i=0;i < rows.length ; i++) { %>
      
      <tr>
        <td><%=(i+1) + (curpage -1) * 20 %></td>
        <td><%=rows[i].ZCODE%></td>
        <td><%=rows[i].NAME%></td>
        <td> <%=rows[i].myd %> </td>
        <td><%=rows[i].ZVOL%></td>
        <td><%= parseFloat(rows[i].ZVOL) + parseFloat(rows[i].bv) %></td>
        
      </tr>
    
  <%}%>  
    
  </table>
   
  <div class="pagebar">  
   
  </div>

</div>
          
  
  
</div>

<div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="exampleModalLabel">选择日期</h4>
      </div>
      
      <div class="modal-body" style="margin-left: 20px;">
      
      </div>
    
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
        <button type="button" class="btn btn-primary" id="enterdate" style="width:100px">确定</button>
      </div>
      
    </div>
  </div>
</div>
  
</div>  
  
 


<script src="/pagebar.js" type="application/javascript"></script>
<script>
  $(document).ready(function(){
    
    $('div.pagebar').pagebar(<%=rowcount%>,<%=curpage%>,'/index?page=$$&date=<%=curdate%>');
    
    $('.sbdatepicker,.icon-th').datepicker({
      language: "zh-CN",
      todayHighlight: true
    });
    
    
    
    $('div.modal-content .modal-body').datepicker({
      forceParse: false,
      todayHighlight: true,
      language: "zh-CN",
      todayHighlight: true
      //defaultViewDate: { year:<%=curdate.split('-')[0]%>, month:<%=parseInt(curdate.split('-')[1])-1%>, day:<%=curdate.split('-')[2]%> }
    }).on('changeDate',function(e){
      $('#enterdate').attr('changedate',e.date.getFullYear() + '-' + (e.date.getMonth()+1) + '-' + e.date.getDate());
    });
    
    $('#enterdate').on('click',function(){
      $('.bs-example-modal-sm').modal('hide');
      var mydate = $('div.modal-content .modal-body').datepicker('getdate');
      location.href = '/index?date=' + $(this).attr('changedate') + "<%- zcode ? '&zcode=' + zcode : ''%>";
    });
    
    
        
  });
          
</script>  
  
<%- include('./footer.html') %>
  
